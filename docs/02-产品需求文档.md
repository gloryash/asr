# 产品需求文档 (PRD)

> 文档版本：v2.0
> 更新日期：2026-01-29
> 文档状态：已审核
> 技术栈：React 19 + TypeScript + Vite

---

## 1. 文档概述

### 1.1 产品名称

语音对话模块（Voice Chat Module）

### 1.2 产品定位

一个**可复用的实时语音交互基础能力组件**，为开发者提供开箱即用的语音识别、语音合成、语音活动检测等能力。

### 1.3 目标用户

- 产品经理（用户访谈、原型演示）
- 创业团队/个人开发者（快速集成语音能力）
- 学生/初学者（学习实践、毕业设计）

---

## 2. 产品目标

### 2.1 核心目标

| 目标 | 衡量指标 |
|------|----------|
| 降低语音交互开发门槛 | 5 分钟内跑通 Demo |
| 提供可复用的模块化组件 | 各模块可独立使用 |
| 支持中文语音交互场景 | 中文识别准确率 > 95% |

### 2.2 非目标（明确不做）

- 不做语音算法研发（使用第三方 API）
- 不做后端服务（纯前端实现）
- 不做多语言支持（聚焦中文）

---

## 3. 功能需求

### 3.1 功能清单

| 模块 | 功能 | 优先级 | 状态 |
|------|------|--------|------|
| 语音识别 | 实时语音转文字 | P0 | 已完成 |
| 语音合成 | 文字转语音播放 | P0 | 已完成 |
| 语音活动检测 | 检测用户是否在说话 | P0 | 已完成 |
| 对话引擎 | 整合各模块的完整对话流程 | P0 | 已完成 |
| 访谈记录 | 记录对话内容并导出 | P1 | 待开发 |

### 3.2 功能详细描述

#### 3.2.1 语音识别（ASR）

**功能描述**：将用户的语音实时转换为文字

**输入**：
- PCM 音频流（16kHz, 16bit, 单声道）

**输出**：
- 识别文本（中间结果 + 最终结果）
- 识别状态（识别中/完成/错误）

**技术方案**：
- 使用阿里云 Paraformer 实时语音识别
- WebSocket 全双工通信

---

#### 3.2.2 语音合成（TTS）

**功能描述**：将文字转换为语音并播放

**输入**：
- 待合成的文本字符串

**输出**：
- PCM 音频流（实时播放）

**技术方案**：
- 使用阿里云 CosyVoice 语音合成
- 支持多种音色选择

---

#### 3.2.3 语音活动检测（VAD）

**功能描述**：检测用户是否正在说话

**输入**：
- PCM 音频数据

**输出**：
- 语音开始事件
- 语音结束事件

**技术方案**：
- 基于音量阈值的简易 VAD
- 可配置静默时长和最短语音时长

---

#### 3.2.4 对话引擎

**功能描述**：整合录音、VAD、ASR、TTS 的完整对话流程

**输入**：
- 用户语音 / 文本消息

**输出**：
- AI 回复文本
- AI 回复语音

**核心流程**：
```
用户说话 → VAD检测 → ASR识别 → LLM处理 → TTS合成 → 播放
```

---

#### 3.2.5 访谈记录（新功能）

**功能描述**：记录语音对话内容，支持导出

**输入**：
- 对话过程中的所有文本

**输出**：
- 结构化的访谈记录
- 可导出的文件格式（JSON/TXT/Markdown）

**记录内容**：
| 字段 | 说明 |
|------|------|
| timestamp | 时间戳 |
| role | 角色（user/assistant） |
| content | 对话内容 |
| duration | 语音时长（可选） |

---

## 4. 非功能需求

### 4.1 性能要求

| 指标 | 要求 |
|------|------|
| ASR 延迟 | < 500ms |
| TTS 首包延迟 | < 300ms |
| 内存占用 | < 100MB |

### 4.2 兼容性要求

| 浏览器 | 最低版本 |
|--------|----------|
| Chrome | 66+ |
| Firefox | 76+ |
| Safari | 14.1+ |
| Edge | 79+ |

### 4.3 安全要求

- API Key 不应硬编码在前端代码中（生产环境）
- 支持 HTTPS 部署

---

## 5. 约束与依赖

### 5.1 技术依赖

| 依赖 | 说明 |
|------|------|
| 阿里云 DashScope | ASR/TTS/LLM 服务 |
| Web Audio API | 音频录制和播放 |
| WebSocket | 实时通信 |

### 5.2 约束条件

- 需要 HTTPS 或 localhost 环境（麦克风权限）
- 需要用户授权麦克风权限
- 依赖网络连接（调用云端 API）

---

## 6. 版本规划

| 版本 | 功能 | 状态 |
|------|------|------|
| v1.0 | 基础语音对话能力 | 已发布 |
| v1.1 | 访谈记录功能 | 开发中 |
| v1.2 | 多音色切换 | 规划中 |
